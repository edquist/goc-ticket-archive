<!DOCTYPE html>
<html lang="en">
  <head>
  <base href="">
    <title>[20975] CMS_T2_US_Caltech worker node connectivity issues</title>    <meta charset="utf-8" />
    <meta name="verify-v1" content="na5IcAJsZVOfEkboRxuIiZ1zpZgnZiWra+nKcS7nA/o=" />
    <meta name="google-site-verification" content="DLrk3ft4s8b-S2TloLCL2LD_t6wcTjgSluf5pmiu2kA" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <link href="https://ticket.opensciencegrid.org/rss" rel="alternate" type="application/rss+xml" title="GOC Ticket Update feed" />

    <style type="text/css">
      body {
        padding-top: 50px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
     #search {
            width: 300px;
     }

    </style>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>

   <link href="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>

    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.min.css" rel="stylesheet"/>
 <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>


    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0-rc.2/js/select2.min.js"></script>

    <link href="css/ticket.css" rel="stylesheet" />
    <script src="lib/jquery.cookie.js"></script>

    <link href="images/tag_orange.png" rel="icon" type="image/png"/>
    <script src='https://www.google.com/recaptcha/api.js'></script>
  </head>

  <body>
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>

            <a class="brand" style="padding: 6px 0px 0px 6px;" href="http://opensciencegrid.org"><img src="images/osglogo.40x30.png"/></a>
            <ul class="nav">
                <li class="dropdown"><a href="https://ticket.opensciencegrid.org/#" class="dropdown-toggle" data-toggle="dropdown">GOC Ticket <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    <li><a href="https://my.opensciencegrid.org">MyOSG</a></li>
                    <li><a href="https://oim.opensciencegrid.org">OIM</a></li>
                    <li class="active"><a href="https://ticket.opensciencegrid.org/index">Ticket</a></li>
	<li class="divider"></li>
	<li><a href="http://repo.grid.iu.edu">Repo</a></li>
	<li class="divider"></li>
	<li><a href="http://blogs.grid.iu.edu">Blog</a></li>
                    <li><a href="http://display.grid.iu.edu">Display</a></li>
                    <li><a href="http://osggoc.blogspot.com/">News</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav pull-right">
                <li><a href="https://ticket.opensciencegrid.org/sso/">Login</a></li>            </ul>

            <div class="nav-collapse">
                <ul class="nav">
			 <li id="menu_submit"><a href="https://ticket.opensciencegrid.org/submit">Submit</a></li><li id="menu_view" class="dropdown"><a href="https://ticket.opensciencegrid.org/\#" class="dropdown-toggle" data-toggle="dropdown">View <b class="caret"></b></a><ul class="dropdown-menu"><li id="submenu_listopen"><a href="https://ticket.opensciencegrid.org/list/open">Open Tickets</a></li><li id="submenu_listrecentclose"><a href="https://ticket.opensciencegrid.org/list/recentclose">Recently Closed Tickets</a></li><li class="divider"></li><li id="submenu_alltickets"><a href="https://ticket.opensciencegrid.org/search?q=&amp;sort=id">All Tickets</a></li></ul></li>                </ul>

                <form class="navbar-search pull-right" action="https://ticket.opensciencegrid.org/viewer">
                    <input id="search" type="text" name="id" class="search-query span2" placeholder="Search Ticket" value=""/>
                </form>
            </div>
        </div>
      </div>
    </div>

<script type='text/javascript' src='lib/jquery.timeago.js'></script>
<script type='text/javascript' src='lib/byte2size.js'></script>
<style>
#updates .toolbar {
position: relative;
margin-top: 0px;
top: -10px;
font-weight: normal;
}
#updates a.anchor {
position: relative;
top: -50px;
}
#updates .selected pre {
animation:selected 2s;
animation-iteration-count: 2;
animation-direction: alternate;
-webkit-animation:selected 2s; 
-webkit-animation-iteration-count: 2;
-webkit-animation-direction: alternate;
box-shadow: inset 1px 1px 20px #9ad;
border: 1px solid #9ab;
margin: 5px 0px;
padding-left: 10px;
}
@keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ab;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
@-webkit-keyframes selected {
    from  {
        box-shadow: inset 1px 1px 20px #9ad;
        border: 1px solid #9ad;
    }
    to {
        box-shadow: inset 1px 1px 20px #05c;
        border: 1px solid #05c;
    }
}
#updates pre {
background-color: inherit;
line-height: 15px;
padding: 5px;
}
#updates .header {
color: #999;
}
#updates .update_history pre {
background-color: #eee;
color: #666;
font-size: 85%;
}
#updates .clickable {
cursor: pointer;
}
#updates .clickable:hover {
color: #D98719;
}
#updates .meta_information pre {
background-color: #fed;
}
#similar_tickets {
max-height: 300px;
overflow-y: auto;
pointer-events: none;
padding: 5px;
background-color: #f4f4f4;
}
.btn-toolbar {
margin-bottom: 0;
height: 30px;
}
#peers {
position: fixed;
bottom: 0px;
right: 0px;
z-index: 100;
list-style: none;
padding: 5px 0px 0px 5px;
margin: 0px;
background-color: white;
box-shadow: 0px 0px 10px white;
}
#peers li {
background-color: #ccc;
color: #000;
display: inline-block;
padding: 5px 10px;
margin-right: 5px;
position: relative;
}
/*
#peers li:hover {
background-color: #999;
cursor: pointer;
}
*/
#peers span.ip {
padding-left: 5px;
color: #666;
}
#peers .new {
bottom: -30px;
}
/*
#peers .me {
background-color: red;
}
*/
</style>

<div class="container-fluid">
<ul id="peers"></ul>
<div class="alert alert-danger"><a class="close" href="https://ticket.opensciencegrid.org/#" data-dismiss="alert">&times;</a>By the end of May 2018, the ticketing system at https://ticket.opensciencegrid.org will be retired and support will be provided at https://support.opensciencegrid.org. Throughout this transition the support email (help@opensciencegrid.org) will be available as a point of contact.<br><br>                                                   
                                                                                                                                                                                   
Please see the service migration page for details: https://opensciencegrid.github.io/technology/policy/service-migrations-spring-2018/#ticket</div><div id="presence" class="pull-right"></div><div class="ticketgui"><script type="text/javascript" src="lib/checktab.js"></script>

<script>
var expanded = false;
function expand_description() {
    var desc = $(".description");
    if(!expanded) {
        expanded = true;
        //expand to minheight
        var min = 250;
        if(desc.height() < min) {
            desc.animate({height: min}, 200);
        }
    }
}

$(document).ready(function() {
    $("input[name='nad']").datepicker({
        dateFormat: 'yy-mm-dd'
    });
});

</script>



<style>
.form-horizontal .control-label {
padding-top: inherit;
font-size:90%;
color:#666;
}
label {
margin-bottom: 0px;
}
.controls {
line-height: 18px;
}
</style>
<form class="form-horizontal" action="https://ticket.opensciencegrid.org/viewer/updatebasic?id=20975" method="post">
<div class="page-header">
    <h3><span class="muted">20975</span> / CMS_T2_US_Caltech worker node connectivity issues</h3>
</div>

<div class="row-fluid">
<div class="span5">
    <legend>Contact</legend>
    <div class="control-group">
        <label class="control-label">Full Name</label>
        <div class="controls">Luis Emiro</div>
    </div>
    <div class="control-group">
        <label class="control-label">Email</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">Phone</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>
    <div class="control-group">
        <label class="control-label">CC</label>
        <div class="controls">
            <i class="icon-lock"></i>        </div>
    </div>

    <legend>Details</legend>
    <div class="control-group"><label class="control-label">Associated VO</label><div class="controls">CMS</div></div><div class="control-group"><label class="control-label">Submitted Via</label><div class="controls">GGUS</div></div><div class="control-group"><label class="control-label">Submitter</label><div class="controls">Luis Emiro Linares Garcia</div></div><div class="control-group"><label class="control-label">Support Center</label><div class="controls">USCMS_Tier2</div></div>
    <div class="control-group">
        <label class="control-label">Ticket Type</label>
        <div class="controls">Problem/Request</div>
    </div>
    <div class="control-group">
        <label class="control-label">Priority</label>
        <div class="controls">Elevated</div>
    </div>
    <div class="control-group">
        <label class="control-label">Status</label>
        <div class="controls">
Closed</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action</label>
        <div class="controls">TX Incoming</div>
    </div>
    <div class="control-group">
        <label class="control-label">Next Action Deadline</label>
        <div class="controls flag_red">2014-05-20</div>
    </div>

</div><!--span-->
<div class="span7">
    <legend>Assignees</legend>
    <div class="assignee" style="width: 60%">USCMS Tier 2 <span class="muted"> / OSG Support Centers</span></div><div class="assignee" style="width: 60%">GGUS (Prod)&nbsp;<a target="_blank" href="https://ggus.eu/ws/ticket_info.php?ticket=105108">105108</a> <span class="muted"> / Ticket Exchange</span></div>    <br>

    <legend>Assignees</legend>
    TODO
    <br>

    <style>
legend.noborder {
border-bottom: none;
}
</style>

<div id="attachment-list"/>
<script>
$(function () {
    var first = true;
    $.getJSON("attachment/list/20975", function (files) {
        //console.dir(files);
        var html = "<table class=\"table table-condensed\">";
        $(files).each(function() {
            if(first) {
                first = false;
                html += "<legend class=\"noborder\">Attachmenets</legend>";
            }
            html += "<tr class=\"attachment\">";
            html += "<td><img src="\&quot;&quot;+this.thumbnail_url+&quot;\&quot;/"></td>";
            html += "<td><a href="\&quot;&quot;+this.url+&quot;\&quot;" target=\"_blank\">"+this.name+"</a></td>";
            html += "<td>"+bytesToSize(this.size, 1)+"</td>";
            html += "</tr>";
        });
        html += "</table>";
        $("#attachment-list").html(html);
    });
});

function download(url) {
    window.open(url, "_blank");
}
</script>


</div><!--span-->
</div><!--row-fluid-->


</form>

</div>
<div id="updates" style="clear: both;">
    <legend>Past Updates
    <div class="btn-toolbar pull-right toolbar">
        <div class="btn-group">
                <a class="btn btn-small" href="https://ticket.opensciencegrid.org/20975?sort=up&amp;"><i class="icon-arrow-up"></i> Sort</a>

        
        <a class="btn btn-small" href="https://ticket.opensciencegrid.org/20975?expandall=true&amp;">Expand Descriptions</a>        <a class="btn btn-small" target="_blank" href="mailto:osg@tick.globalnoc.iu.edu?subject=Open%20Science%20Grid%3A%20CMS_T2_US_Caltech%20worker%20node%20connectivity%20issues%20ISSUE%3D20975%20PROJ%3D71"><i class="icon-envelope"></i> Update w/Email</a>
        </div>
    </div><!--btn-toolbar-->
    </legend>

    <div class='update_description'><i onclick="document.location='20975#1401926416'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-06-05T00:00:16+00:00">Jun 5, 2014 12:00 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1401926416">&nbsp;</a></div><pre>This ticket was closed automatically. If this issue has not been resolved according your expectations or if you need further information, please submit a new ticket referencing this one.

-- by SYSTEM at Wed Jun 04 23&#58;59&#58;09 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1400607266'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-20T17:34:26+00:00">May 20, 2014 05:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1400607266">&nbsp;</a></div><pre>Hi Samir,

Yes, I think we can close this ticket. I see the validation failures you mentioned over the weekend, as well as a few more this morning. They were not wget problems - instead, the glideins were complaining about disk space again&#58;

mktemp&#58; failed to create directory via template &#96;/tmp/wmsglide_XXXXXX&#39;&#58; No space left on device
=== Validation error in /wntmp/condor/compute-6-40/execute/dir_28046/glide_oyUYeo/main/validate_node.sh ===
Tue May 20 06&#58;49&#58;32 PDT 2014 Error running &#39;/wntmp/condor/compute-6-40/execute/dir_28046/glide_oyUYeo/main/validate_node.sh&#39;
Cannot create a dir in /tmp

However, these space issues appear to be on the decline, so I&#39;m not going to fuss about them. And you said you were working on a solution anyway. Since the original issue is gone, and any lingering issues appear to be temporary, I&#39;ll close &#39;er up!

Thanks,
DanSite admin added network proxy that improved wget performance of glideins.

-- by Daniel Klein at Tue May 20 17&#58;33&#58;27 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1400604337'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-20T16:45:37+00:00">May 20, 2014 04:45 PM UTC</time><a class="anchor" name="1400604337">&nbsp;</a></div><pre>For the last 12h plots look dark green for most part and red for &#60; 10% &#58;

<a href='http&#58;//vocms32.cern.ch/gfactory/factoryCompletedStats.html?entry=CMS_T2_US_Caltech_cit2&frontend=total&infoGroup=badput' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/gfactory/factoryCompletedStats.html?entry=CMS_T2_US_Caltech_cit2&frontend=total&infoGroup=badput</a>

Anything left to look at here? Shall we close the ticket?

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1400519333'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-19T17:08:53+00:00">May 19, 2014 05:08 PM UTC</time><a class="anchor" name="1400519333">&nbsp;</a></div><pre>Thanks,

What I found &#58;

compute-14-42 &#58; OSG jobs doing a nice job filling /tmp again &#58;-) Fixed
compute-13-19 &#58; old Puppet profile broke osg-wn-client. Fixed

For the WGET failure, if it&#39;s a single it could be negligible. I saw many &#34;redness&#34; for glideins over the weekend though (fine for several hours now). Were these WGET failures?

If we&#39;re fine in the general and WGET land, maybe it&#39;s time to close the ticket? Job submission rate has been decent in the last days so no complaints from my side either.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1400508696'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-19T14:11:36+00:00">May 19, 2014 02:11 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1400508696">&nbsp;</a></div><pre>lulingar@....i Samir,

So I have some news for you.

On node compute-14-42.tier2 there has been validation failures all like [1].
On node compute-13-19.tier2 we get failures like [2].
On node compute-22-13.tier2 there was a single wget failure [3] at timestamp 2014-05-15T14&#58;42&#58;58-07&#58;00. Probably not relevant now.

This is all looking better every time.

Cheers,
Luis
[1]
Validation failed in main/validate_node.sh.
Cannot create a dir in /tmp

[2]
Validation failed in main/setup_x509.sh.
grid-proxy-init command not found in path!

[3]
Validation failed in wget.
Failed to load file &#39;glidein_memory_setup.db5a4q.sh&#39; from &#39;<a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3&#39' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3&#39</a>;.

-- by Luis Emiro Linares Garcia at Fri May 16 09&#58;58&#58;45 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1400234326'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-16T09:58:46+00:00">May 16, 2014 09:58 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1400234326">&nbsp;</a></div><pre>Hi Samir,

So I have some news for you.

On node compute-14-42.tier2 there has been validation failures all like [1].
On node compute-13-19.tier2 we get failures like [2].
On node compute-22-13.tier2 there was a single wget failure [3] at timestamp 2014-05-15T14&#58;42&#58;58-07&#58;00. Probably not relevant now.

This is all looking better every time.

Cheers,
Luis
[1]
Validation failed in main/validate_node.sh.
Cannot create a dir in /tmp

[2]
Validation failed in main/setup_x509.sh.
grid-proxy-init command not found in path!

[3]
Validation failed in wget.
Failed to load file &#39;glidein_memory_setup.db5a4q.sh&#39; from &#39;<a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3&#39' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3&#39</a>;.

-- by Luis Emiro Linares Garcia at Fri May 16 09&#58;57&#58;38 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1400176234'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-15T17:50:34+00:00">May 15, 2014 05:50 PM UTC</time><a class="anchor" name="1400176234">&nbsp;</a></div><pre>Ok, the downtime paragraph needs some corrections clarifications &#58;

* cit-gatekeeper2.ultralight.org (and corresponding entries) are perfectly fine and handling job submission very well at the moment
* cit-gatekeeper.ultrtalight.org is not working properly and I scheduled a downtime for a complete upgrade of the OS/Software (see OIM for complete description).

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1400176064'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-15T17:47:44+00:00">May 15, 2014 05:47 PM UTC</time><a class="anchor" name="1400176064">&nbsp;</a></div><pre>I don&#39;t know if anything changed in the GlideInWMS side, but since this morning the job submission rate improved a lot, and is now what I would expect for normal operations &#58;

81 JMA 2014/05/15 07
149 JMA 2014/05/15 08
373 JMA 2014/05/15 09
428 JMA 2014/05/15 10

~400 jobs per hour. Not all of these are CMS jobs but this will do.

On the other hand, while trying to improve job admission rate in cit-gatekeeper.ultralight.org (primary entry for you guys) it actually got worse. As the newly upgraded CE (cit-gatekeeper2.ultralight.org) is having very good performance I&#39;ve set an UNSCHEDULED OIM downtime in the resource until 1 PM PST. Don&#39;t expect anything to work there before that.

If you see any change in the wget failure rate let me know, I&#39;m curious to know how the new proxy is doing.

Cheers,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1400162185'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-15T13:56:25+00:00">May 15, 2014 01:56 PM UTC</time><a class="anchor" name="1400162185">&nbsp;</a></div><pre>Switch is done &#58;

-bash-4.1$ globus-job-run cit-gatekeeper2.ultralight.org /bin/env | grep 62
OSG_SQUID_LOCATION=10.3.11.62&#58;3128

Let&#39;s watch for WGET failures. The job submission rate improved a bit, ~100 jobs per hour, from CMS &#58;

[root@cithep252 osg]# grep &#39;has GRAM_SCRIPT_JOB_ID&#39; /var/log/globus-gatekeeper.log   | grep condor | awk -F&#39;&#58;&#39; &#39;{print $1}&#39; | sort | uniq -c
82 JMA 2014/05/15 03
95 JMA 2014/05/15 04
212 JMA 2014/05/15 05
110 JMA 2014/05/15 06

Cheers,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1400125529'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-15T03:45:29+00:00">May 15, 2014 03:45 AM UTC</time><a class="anchor" name="1400125529">&nbsp;</a></div><pre>So the new proxy is deployed, I will migrate in the CE configuration tomorrow morning to avoid any incident overnight.

The full /tmp problem is solved for now. OSG jobs were filling /tmp with a directory /tmp/ngramwork that had 26 GB of data in it. Automation to spot/fix this will come later.

Cheers,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1400123270'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-15T03:07:50+00:00">May 15, 2014 03:07 AM UTC</time><a class="anchor" name="1400123270">&nbsp;</a></div><pre>Thanks for pointing out the /tmp full nodes. as the biggest weak-spot of our site is the proxy, I&#39;m looking into that first. It seems that all URLs work from/to research networks, so I&#39;m going ahead with the 10 Gbps proxy deployment.

On another topic, I finished a transparent CE upgrade today to OSG 3.2 GRAM, and after the new CE came back online (cit-gatekeeper2.ultralight.org) I see that the job submission rate is very poor &#58; ~25 jobs per hour(!). Analysis pressure seems fine &#58;

<a href='http&#58;//submit-3.t2.ucsd.edu/CSstoragePath/Monitor/latest.txt' target='_blank' rel='nofollow'>http&#58;//submit-3.t2.ucsd.edu/CSstoragePath/Monitor/latest.txt</a>

[root@cithep252 etc]# grep &#39;has GRAM_SCRIPT_JOB_ID&#39; /var/log/globus-gatekeeper.log   | grep condor | awk -F&#39;&#58;&#39; &#39;{print $1}&#39; | sort | uniq -c
23 JMA 2014/05/14 18
24 JMA 2014/05/14 19

Independent of that, we seem to be affected by this since past week when we had to vacate parts of the cluster at once. Ramp-ups are very slow. There&#39;s any way that we can have a higher job submission rate?

It seems to me that in the current configuration, sites look good as long as there are no abrupt ramp-downs, as it can take a day or more to fill up 2000 slots again with CMS jobs.

If it can&#39;t be changed, fine for me, but if it can, even if it needs a ticket in special cases when we need to speed up job start rate, it would help. At this rate, to occupy 2000 slots back we will take 80h.

Cheers,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1400110536'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-14T23:35:36+00:00">May 14, 2014 11:35 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1400110536">&nbsp;</a></div><pre>Hi Samir,

I see a few instances of this error, which Luis reported earlier&#58;

Wed May 14 11&#58;26&#58;17 PDT 2014 Error running &#39;/wntmp/condor/compute-21-20/execute/dir_13904/glide_fZay4t/main/validate_node.sh&#39;
Space on &#39;/tmp&#39; not enough.
At least 10 MBs required, found 4872 KBs

This error appears primarily on compute-21-20.tier2, though also a few times on
compute-22-19.tier2
compute-21-14.tier2
compute-6-0.tier2

However, I mainly see wget failures again&#58;

Validation failed in wget.
Failed to load file &#39;constants.e1sa6p.cfg&#39; from &#39;<a href='http&#58;//gfactory-1.t2.ucsd.edu/glidefactory//stage/glidein_v3_0&#39' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/glidefactory//stage/glidein_v3_0&#39</a>;.

Now, hopefully I can supply you with the info you need to test the network paths. First, the list of nodes is&#58;
compute-10-30.tier2
compute-11-24.tier2
compute-12-14.tier2
compute-12-15.tier2
compute-12-16.tier2
compute-13-19.tier2
compute-14-13.tier2
compute-14-17.tier2
compute-14-19.tier2
compute-14-21.tier2
compute-14-25.tier2
compute-14-34.tier2
compute-14-35.tier2
compute-14-44.tier2
compute-14-55.tier2
compute-16-10.tier2
<div id='show_538250257' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_538250257'>compute-16-11.tier2
compute-16-16.tier2
compute-16-18.tier2
compute-16-25.tier2
compute-16-28.tier2
compute-20-13.tier2
compute-20-14.tier2
compute-20-15.tier2
compute-20-16.tier2
compute-20-19.tier2
compute-20-31.tier2
compute-20-40.tier2
compute-21-23.tier2
compute-21-26.tier2
compute-22-17.tier2
compute-22-19.tier2
compute-22-23.tier2
compute-22-29.tier2
compute-22-32.tier2
compute-22-34.tier2
compute-22-35.tier2
compute-22-38.tier2
compute-6-0.tier2
compute-6-17.tier2
compute-6-1.tier2
compute-6-24.tier2
compute-6-28.tier2
compute-6-2.tier2
compute-6-37.tier2

Here are some examples of locations from whence the files cannot be downloaded&#58;
<a href='http&#58;//gfactory-1.t2.ucsd.edu/glidefactory//stage/glidein_v3_0' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/glidefactory//stage/glidein_v3_0</a>
<a href='http&#58;//gfactory-1.t2.ucsd.edu/glidefactory//stage/glidein_v3_0/entry_CMS_T2_US_Caltech_cit2' target='_blank' rel='nofollow'>http&#58;//gfactory-1.t2.ucsd.edu/glidefactory//stage/glidein_v3_0/entry_CMS_T2_US_Caltech_cit2</a>
<a href='http&#58;//osg-flock.grid.iu.edu/vofrontend/stage' target='_blank' rel='nofollow'>http&#58;//osg-flock.grid.iu.edu/vofrontend/stage</a>
<a href='http&#58;//osg-flock.grid.iu.edu/vofrontend/stage/group_main' target='_blank' rel='nofollow'>http&#58;//osg-flock.grid.iu.edu/vofrontend/stage/group_main</a>
<a href='http&#58;//portal.nebiogrid.org/monitoring/osg/vofrontend/stage/frontend_NEBioGrid-v1_2' target='_blank' rel='nofollow'>http&#58;//portal.nebiogrid.org/monitoring/osg/vofrontend/stage/frontend_NEBioGrid-v1_2</a>
<a href='http&#58;//portal.nebiogrid.org/monitoring/osg/vofrontend/stage/frontend_NEBioGrid-v1_2/group_main' target='_blank' rel='nofollow'>http&#58;//portal.nebiogrid.org/monitoring/osg/vofrontend/stage/frontend_NEBioGrid-v1_2/group_main</a>
<a href='http&#58;//vocms157.cern.ch/vofrontend/stage/frontend_CMS-CERN/group_main' target='_blank' rel='nofollow'>http&#58;//vocms157.cern.ch/vofrontend/stage/frontend_CMS-CERN/group_main</a>
<a href='http&#58;//glidein-frontend.t2.ucsd.edu&#58;8319/vofrontend/stage/frontend_UCSD-v7_0' target='_blank' rel='nofollow'>http&#58;//glidein-frontend.t2.ucsd.edu&#58;8319/vofrontend/stage/frontend_UCSD-v7_0</a>
<a href='http&#58;//glidein-frontend.t2.ucsd.edu&#58;8319/vofrontend/stage/frontend_UCSD-v7_0/group_main' target='_blank' rel='nofollow'>http&#58;//glidein-frontend.t2.ucsd.edu&#58;8319/vofrontend/stage/frontend_UCSD-v7_0/group_main</a>

I hope this helps!

Best,
Dan

-- by Daniel Klein at Wed May 14 23&#58;34&#58;37 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a>
</div><script type='text/javascript'>
        $('#show_538250257').click(function() {
            $('#detail_538250257').slideDown("normal");
            $('#show_538250257').hide();
            $('#hide_538250257').show();
        });
        $('#hide_538250257').click(function() {
            $('#detail_538250257').slideUp();
            $('#hide_538250257').hide();
            $('#show_538250257').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='20975#1400106679'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-14T22:31:19+00:00">May 14, 2014 10:31 PM UTC</time><a class="anchor" name="1400106679">&nbsp;</a></div><pre>Hi,

We had a problem in the CE where condor was restarting the Schedd every few minutes because.. it couldn&#39;t connect back to dead jobs? Tried to remove the affected jobs but had to kill all running jobs. Now I see very few jobs running in that CE (26) for several hours. I see in the history that the pilots are having a very short duration &#58;

[root@cithep231 ~]# condor_history | grep cms | head -n200
3568407.0   uscms2256       5/14 15&#58;20   0+00&#58;03&#58;03 C   5/14 15&#58;24 /home/uscms2256
3568408.0   uscms2256       5/14 15&#58;21   0+00&#58;02&#58;47 C   5/14 15&#58;24 /home/uscms2256
3568402.0   cmsprod100      5/14 15&#58;16   0+00&#58;03&#58;18 C   5/14 15&#58;21 /home/cmsprod10
3568406.0   uscms2256       5/14 15&#58;19   0+00&#58;02&#58;08 C   5/14 15&#58;21 /home/uscms2256
3568401.0   uscms2256       5/14 15&#58;16   0+00&#58;02&#58;39 C   5/14 15&#58;19 /home/uscms2256
3568397.0   uscms2256       5/14 15&#58;10   0+00&#58;02&#58;55 C   5/14 15&#58;13 /home/uscms2256
3568395.0   uscms0495       5/14 15&#58;06   0+00&#58;01&#58;05 C   5/14 15&#58;07 /home/uscms0495
3568394.0   uscms0495       5/14 15&#58;00   0+00&#58;00&#58;58 C   5/14 15&#58;02 /home/uscms0495
3568393.0   cmsprod100      5/14 14&#58;51   0+00&#58;03&#58;24 C   5/14 14&#58;59 /home/cmsprod10
3568283.0   uscms2256       5/14 09&#58;12   0+05&#58;41&#58;30 C   5/14 14&#58;54 /home/uscms2256
3568390.0   uscms0495       5/14 14&#58;29   0+00&#58;11&#58;14 C   5/14 14&#58;41 /home/uscms0495
3568388.0   uscms0495       5/14 14&#58;25   0+00&#58;11&#58;17 C   5/14 14&#58;36 /home/uscms0495
3568389.0   cmsprod100      5/14 14&#58;25   0+00&#58;04&#58;48 C   5/14 14&#58;31 /home/cmsprod10
3568351.0   uscms4258       5/14 10&#58;38   0+03&#58;30&#58;13 C   5/14 14&#58;09 /home/uscms4258
3568387.0   uscms0495       5/14 14&#58;06   0+00&#58;01&#58;04 C   5/14 14&#58;07 /home/uscms0495
3568386.0   uscms0495       5/14 14&#58;00   0+00&#58;01&#58;04 C   5/14 14&#58;01 /home/uscms0495
3568385.0   cmsprod100      5/14 13&#58;51   0+00&#58;05&#58;55 C   5/14 13&#58;57 /home/cmsprod10
3568366.0   uscms4258       5/14 11&#58;29   0+02&#58;22&#58;09 C   5/14 13&#58;52 /home/uscms4258
3568364.0   uscms4254       5/14 11&#58;29   0+02&#58;22&#58;10 C   5/14 13&#58;51 /home/uscms4254
3568384.0   uscms0495       5/14 13&#58;45   0+00&#58;00&#58;00 X   ???        /home/uscms0495
3568358.0   uscms0495       5/14 11&#58;04   0+02&#58;39&#58;34 C   5/14 13&#58;44 /home/uscms0495
3568382.0   uscms0495       5/14 13&#58;29   0+00&#58;04&#58;37 C   5/14 13&#58;35 /home/uscms0495
3568383.0   cmsprod100      5/14 13&#58;30   0+00&#58;02&#58;29 C   5/14 13&#58;33 /home/cmsprod10
3568365.0   uscms4248       5/14 11&#58;29   0+02&#58;02&#58;34 C   5/14 13&#58;32 /home/uscms4248
3568380.0   uscms0495       5/14 13&#58;24   0+00&#58;04&#58;26 C   5/14 13&#58;29 /home/uscms0495
3568381.0   cmsprod100      5/14 13&#58;24   0+00&#58;02&#58;42 C   5/14 13&#58;27 /home/cmsprod10
3568377.0   uscms0495       5/14 13&#58;06   0+00&#58;01&#58;13 C   5/14 13&#58;07 /home/uscms0495
3568375.0   uscms0495       5/14 12&#58;30   0+00&#58;04&#58;27 C   5/14 12&#58;34 /home/uscms0495
3568376.0   cmsprod100      5/14 12&#58;30   0+00&#58;02&#58;25 C   5/14 12&#58;33 /home/cmsprod10
3568373.0   uscms0495       5/14 12&#58;24   0+00&#58;04&#58;13 C   5/14 12&#58;29 /home/uscms0495
<div id='show_356133520' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_356133520'>3568374.0   cmsprod100      5/14 12&#58;24   0+00&#58;03&#58;18 C   5/14 12&#58;28 /home/cmsprod10
3568341.0   uscms2256       5/14 10&#58;27   0+01&#58;55&#58;33 C   5/14 12&#58;23 /home/uscms2256
3568370.0   uscms0495       5/14 12&#58;06   0+00&#58;01&#58;19 C   5/14 12&#58;07 /home/uscms0495
3568367.0   uscms0495       5/14 11&#58;30   0+00&#58;04&#58;00 C   5/14 11&#58;34 /home/uscms0495
3568368.0   cmsprod100      5/14 11&#58;30   0+00&#58;02&#58;31 C   5/14 11&#58;33 /home/cmsprod10
3568362.0   uscms0495       5/14 11&#58;24   0+00&#58;04&#58;10 C   5/14 11&#58;29 /home/uscms0495

There&#39;s a general failure reason? I&#39;m trying to find the URL and look at the logs myself, but if you already know the reason that will help. AS they only run few minutes I believe that it&#39;s not passing not validation for some reason. Wondering what fails.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira
</div><script type='text/javascript'>
        $('#show_356133520').click(function() {
            $('#detail_356133520').slideDown("normal");
            $('#show_356133520').hide();
            $('#hide_356133520').show();
        });
        $('#hide_356133520').click(function() {
            $('#detail_356133520').slideUp();
            $('#hide_356133520').hide();
            $('#show_356133520').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='20975#1399910669'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-12T16:04:29+00:00">May 12, 2014 04:04 PM UTC</time><a class="anchor" name="1399910669">&nbsp;</a></div><pre>While node-validation has been quite ok, after the ramp-up on Friday, it seems that submission rate went down again &#58;

<a href='http&#58;//dashb-cms-jobsmry.cern.ch/dashboard/request.py/dailysummary#button=resourceutil&sites%5B%5D=T2_US_Caltech&sitesSort=2&start=null&end=null&timerange=last48&granularity=Hourly&generic=0&sortby=1&series=All' target='_blank' rel='nofollow'>http&#58;//dashb-cms-jobsmry.cern.ch/dashboard/request.py/dailysummary#button=resourceutil&sites%5B%5D=T2_US_Caltech&sitesSort=2&start=null&end=null&timerange=last48&granularity=Hourly&generic=0&sortby=1&series=All</a>

We&#39;re having a hard time keeping the farm full of CMS jobs. Now I have ~1500 pilots running on local monitoring, only 1k counted on DashBoard. Over the weekend job submission rate was smaller than job finish rate, resulting in the observed ramp downs ( I looked at the CE logs and spotted few jobs coming in per hour ). OSG&#39;s job submission was much more aggressive (in a good way) and took over the cluster.

If there&#39;s anything GlideInWMS can do to increase the throttle here it will help. Analysis pressure seems pretty ok &#58;

<a href='http&#58;//submit-3.t2.ucsd.edu/CSstoragePath/Monitor/latest.txt' target='_blank' rel='nofollow'>http&#58;//submit-3.t2.ucsd.edu/CSstoragePath/Monitor/latest.txt</a>

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399907254'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-12T15:07:34+00:00">May 12, 2014 03:07 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399907254">&nbsp;</a></div><pre>Sorry for the truncated message, browser error here.

So I was saying, while things are much better now, a few nodes have these disk-full conditions I posted. These are the only failures I have noticed.

Thanks,
Luis

-- by Luis Emiro Linares Garcia at Mon May 12 15&#58;06&#58;55 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1399906114'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-12T14:48:34+00:00">May 12, 2014 02:48 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399906114">&nbsp;</a></div><pre>lulingar@....i Vince, Samir,

Over the past 24 hours pilots have been ramping up. The only failures

&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2848 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2848 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2848 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2848 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 2856 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 3448 KBs
&#60;env name=&#34;hostname&#34;&#62;compute-21-20.tier2&#60;/env&#62;;      At least 10 MBs required, found 3448 KBs

-- by Luis Emiro Linares Garcia at Mon May 12 14&#58;48&#58;23 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1399903793'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-12T14:09:53+00:00">May 12, 2014 02:09 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1399903793">&nbsp;</a></div><pre>Samir and Jeff,

Would you like this leave this ticket open for continued troubleshooting or do you consider this issue resolved?
Please let me know if I can assist.

Thank you,
Vince</pre></div><div class='update_description'><i onclick="document.location='20975#1399680405'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-10T00:06:45+00:00">May 10, 2014 12:06 AM UTC</time><a class="anchor" name="1399680405">&nbsp;</a></div><pre>Cool. I realized that something wasn&#39;t going right with job submission. Even told my users to flood the farm (through CRAB), as it was getting empty.

The ramp up in the last hours is pretty decent, so this is solved.

Back to the real issue, let me know what are the servers that the glideins have to reach through WGET, so I test if the network paths are ok to do the migration to a 10 Gbps proxy. I believe that this will improve/eliminate the wget problem. If you have examples from real files even better so I can test the proxy before switching the configuration for jobs.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399678641'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-09T23:37:21+00:00">May 9, 2014 11:37 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399678641">&nbsp;</a></div><pre>Hi Samir,

As an update, yesterday we discovered issues left over due to the Digicert CRL issues, which required us to restart condor on the factory submit nodes to get glideins to submit normally again&#58;
<a href='https&#58;//savannah.cern.ch/support/?143313' target='_blank' rel='nofollow'>https&#58;//savannah.cern.ch/support/?143313</a>

I saw today that there were a number of stuck held glideins at Caltech left over from before the condor restarts.  I cleared those out and CMS submission seems to be improving at Caltech.

Jeff Dost
OSG Glidein Factory Operations

-- by Jeffrey Dost at Fri May 09 23&#58;37&#58;03 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1399601314'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-09T02:08:34+00:00">May 9, 2014 02:08 AM UTC</time><a class="anchor" name="1399601314">&nbsp;</a></div><pre>Hi,

CMS GlideIn submission became quite flaky today. I see OSG taking over the cluster with their glideins. There was a problem in our Condor where I had to kill all jobs that were trying to restart shadows for running jobs and failing to do so. Now we only have ~50 jobs in cit-gatekeeper.ultralight.org. There&#39;s any chance to increase the submission rate for this CE? there are ~2k cores that could be used for CMS available here.

Or -- if you&#39;re having problems to reach the CE, let me know, but I see your CERN glideins coming in here and there  &#58;

TIME&#58; Thu May  8 19&#58;04&#58;52 2014
PID&#58; 15764 -- Notice&#58; 0&#58; GATEKEEPER_JM_ID 2014-05-08.19&#58;04&#58;52.0000007900.0000000332 for /DC=ch/DC=cern/OU=computers/CN=cmspilotjob/vocms157.cern.ch on &#58;&#58;ffff&#58;129.79.53.27
TIME&#58; Thu May  8 19&#58;04&#58;52 2014
PID&#58; 15764 -- Notice&#58; 5&#58; Requested service&#58; jobmanager-condor
TIME&#58; Thu May  8 19&#58;04&#58;52 2014
PID&#58; 15764 -- Notice&#58; 5&#58; Authorized as local user&#58; cmsprod091
TIME&#58; Thu May  8 19&#58;04&#58;52 2014
PID&#58; 15764 -- Notice&#58; 5&#58; Authorized as local uid&#58; 20238
TIME&#58; Thu May  8 19&#58;04&#58;52 2014
PID&#58; 15764 -- Notice&#58; 5&#58;           and local gid&#58; 505
TIME&#58; Thu May  8 19&#58;04&#58;52 2014
PID&#58; 15764 -- Notice&#58; 0&#58; executing /usr/sbin/globus-job-manager

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399574801'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T18:46:41+00:00">May 8, 2014 06:46 PM UTC</time><a class="anchor" name="1399574801">&nbsp;</a></div><pre>Hi,

I was chatting with my network support. There is a possibility that pilot jobs are using a proxy configured in the CE &#58;

; If you are using squid, specify the location of the squid server in the
; location setting, this should be an url
location = newman.ultralight.org

For these WGETs, that is not really the optimal path. It goes through a 1 Gbps funnel, using campus network =&#62; public internet.

Could you confirm that, and give me an example of URL that they will WGET? My plan is to setup a proxy in the research networks, that we have 10 Gbps or more links. But this is restricted to research networks. We should be fine but I wanted to test before changing anything. Let me know all possibly different URLs (factory/whatever component at CERN, US, etc).

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399536180'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-08T08:03:00+00:00">May 8, 2014 08:03 AM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399536180">&nbsp;</a></div><pre>Hi Samir,

I saw recent wget failures at these nodes&#58;

4 compute-6-23.tier2
2 compute-6-9.tier2
2 compute-31-2.tier2
1 compute-6-40.tier2
1 compute-6-32.tier2
1 compute-6-0.tier2
1 compute-31-4.tier2
1 compute-31-3.tier2
1 compute-22-22.tier2
1 compute-22-17.tier2
1 compute-22-12.tier2
1 compute-21-26.tier2
1 compute-14-11.tier2

Cheers,
Luis

-- by Luis Emiro Linares Garcia at Thu May 08 08&#58;02&#58;34 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1399482611'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-07T17:10:11+00:00">May 7, 2014 05:10 PM UTC</time><a class="anchor" name="1399482611">&nbsp;</a></div><pre>Nothing was done from my side. Things suddenly improved yesterday. Now we have ~consistently green plots, apparently.

This morning we had potentially 2 black hole nodes (failing disks, probably failing jobs). I started having more CMS pending jobs once I addressed these. Let me know if things look good on your side.

Thanks
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399404298'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-06T19:24:58+00:00">May 6, 2014 07:24 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399404298">&nbsp;</a></div><pre>Hi Samir,

The rate of validation failure at Caltech is practically 0% right now, and has been low for the past several days. I think we&#39;re over the wget problems, as you suggested on Friday, and the blips we saw were due to the other causes.

I also took a look at some of the short-lived glideins, and I do see evidence that these glideins are having trouble connecting back to their various frontends. e.g.&#58;

05/06/14 11&#58;24&#58;14 (pid&#58;29290) condor_write()&#58; Socket closed when trying to write 4096 bytes to collector vocms97.cern.ch&#58;9739, fd is 10
05/06/14 11&#58;24&#58;14 (pid&#58;29290) Buf&#58;&#58;write()&#58; condor_write() failed 05/06/14 04&#58;34&#58;05 (pid&#58;1873) condor_read() failed&#58; recv(fd=6) returned -1, errno = 104 Connection reset by peer, reading 21 bytes from collector glidein.unl.edu&#58;9659.

05/06/14 04&#58;34&#58;05 (pid&#58;1873) IO&#58; Failed to read packet header
05/06/14 04&#58;34&#58;05 (pid&#58;1873) CCBListener&#58; failed to receive message from CCB server glidein.unl.edu&#58;9659

05/06/14 11&#58;49&#58;04 (pid&#58;27569) condor_read() failed&#58; recv(fd=12) returned -1, errno = 104 Connection reset by peer, reading 21 bytes from schedd at &#60;128.142.176.228&#58;4080&#62;.
05/06/14 11&#58;49&#58;04 (pid&#58;27569) IO&#58; Failed to read packet header
05/06/14 11&#58;49&#58;04 (pid&#58;27569) Response problem from schedd &#60;128.142.176.228&#58;4080?sock=50252_b96e_3&#62; on ALIVE job -1.-1.

The phenomenon does not appear to be worker node-specific, because the short glideins were thinly spread over a long list of nodes. Also, these same nodes all ran non-short glideins the same day. For completeness&#39; sake, I&#39;ll paste a partial list below, but as I said, I don&#39;t think it&#39;s a node-specific behavior. Do you know of any network settings etc. that might be interrupting network traffic between glideins and frontends?

Thanks,
Dan

---
List of nodes where CMS production glideins passed validation, but ran zero user jobs today&#58;
compute-10-11.tier2
compute-10-23.tier2
compute-10-5.tier2
compute-11-20.tier2
compute-12-13.tier2
compute-12-18.tier2
compute-14-10.tier2
compute-14-13.tier2
compute-14-17.tier2
compute-14-19.tier2
compute-14-23.tier2
compute-14-24.tier2
<div id='show_373477911' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_373477911'>compute-14-29.tier2
compute-14-33.tier2
compute-14-44.tier2
compute-14-51.tier2
compute-14-56.tier2
compute-14-6.tier2
compute-14-7.tier2
compute-16-25.tier2
compute-16-32.tier2
compute-20-15.tier2
compute-20-17.tier2
compute-20-19.tier2
compute-20-20.tier2
compute-20-24.tier2
compute-20-2.tier2
compute-20-32.tier2
compute-20-36.tier2
compute-20-39.tier2
compute-20-42.tier2
compute-20-43.tier2
compute-20-5.tier2
compute-21-14.tier2
compute-21-15.tier2
compute-21-16.tier2
compute-21-19.tier2
compute-21-21.tier2
compute-21-25.tier2
compute-21-26.tier2
compute-21-6.tier2
compute-22-11.tier2
compute-22-16.tier2
compute-22-17.tier2
compute-22-20.tier2
compute-22-21.tier2
compute-22-22.tier2
compute-22-29.tier2
compute-22-36.tier2
compute-22-38.tier2
compute-31-3.tier2
compute-31-4.tier2
compute-6-10.tier2
compute-6-11.tier2
compute-6-12.tier2
compute-6-13.tier2
compute-6-15.tier2
compute-6-17.tier2
compute-6-18.tier2
compute-6-19.tier2
compute-6-20.tier2
compute-6-23.tier2
compute-6-24.tier2
compute-6-26.tier2
compute-6-29.tier2
compute-6-31.tier2
compute-6-36.tier2
compute-6-37.tier2
compute-6-3.tier2
compute-6-4.tier2
compute-6-5.tier2
compute-6-7.tier2

-- by Daniel Klein at Tue May 06 19&#58;24&#58;25 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a>
</div><script type='text/javascript'>
        $('#show_373477911').click(function() {
            $('#detail_373477911').slideDown("normal");
            $('#show_373477911').hide();
            $('#hide_373477911').show();
        });
        $('#hide_373477911').click(function() {
            $('#detail_373477911').slideUp();
            $('#hide_373477911').hide();
            $('#show_373477911').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='20975#1399396487'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-06T17:14:47+00:00">May 6, 2014 05:14 PM UTC</time><a class="anchor" name="1399396487">&nbsp;</a></div><pre>Hi Vince,

If you find what are the nodes failing GlideIns that might help finding the culprits. At the moment I have the farm full of glideins although the length plots don&#39;t look that good. General job performance looks good though &#58;

<a href='http&#58;//dashb-cms-jobsmry.cern.ch/dashboard/request.py/dailysummary#button=successfailures&sites%5B%5D=T2_US_Caltech&sitesSort=2&start=null&end=null&timerange=last48&granularity=Hourly&generic=0&sortby=1&series=All' target='_blank' rel='nofollow'>http&#58;//dashb-cms-jobsmry.cern.ch/dashboard/request.py/dailysummary#button=successfailures&sites%5B%5D=T2_US_Caltech&sitesSort=2&start=null&end=null&timerange=last48&granularity=Hourly&generic=0&sortby=1&series=All</a>

I never saw it so high.

But if you have a distribution of nodes failing glideins and/or reason of failure I can look at it.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399385790'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-06T14:16:30+00:00">May 6, 2014 02:16 PM UTC</time> by <b>Vince Neal</b><a class="anchor" name="1399385790">&nbsp;</a></div><pre>Greetings,

Checking in to see how things have gone since Friday.
If I can assist please let me know.

Thank you,
Vince</pre></div><div class='update_description'><i onclick="document.location='20975#1399072673'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-02T23:17:53+00:00">May 2, 2014 11:17 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399072673">&nbsp;</a></div><pre>Hi Samir,

I do see a big spike of validation failures around 2PM today, and after that we don&#39;t have a lot of completed glideins to tell by. So I agree, let&#39;s leave it over the weekend, and we&#39;ll check back on Monday to see if things have stabilized.

Cheers,
Dan

-- by Daniel Klein at Fri May 02 23&#58;17&#58;24 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1399068422'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-02T22:07:02+00:00">May 2, 2014 10:07 PM UTC</time><a class="anchor" name="1399068422">&nbsp;</a></div><pre>Hi Dan,

Sounds good. I should add that the CRL problem finally hit us today, I wasn&#39;t awake to tell but I see glitches on general services from Thursday 11&#58;30 PM to 1&#58;00 AM Friday, then around lunch time we had our GUMS failing auth for everything and I&#39;m guessing that some glideIns (or glExec more specifically) would have been affected.

I would say that after 1 PM Friday we shouldn&#39;t see a lot of failures, unless things break again, which, as DigiCert fixed their side, is unlikely. Let&#39;s see how this evolves through today and the weekend.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399062891'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-02T20:34:51+00:00">May 2, 2014 08:34 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399062891">&nbsp;</a></div><pre>Hi Samir,

The earliest occurrence of this error I can find is Tuesday at 13&#58;13 (PDT), and the most recent is today at around 08&#58;35 (PDT). This would seem to correlate with your network outages. Since ~9&#58;00 this morning I haven&#39;t seen any more wget errors. I propose to keep an eye on this today, and if it looks good at the end of the day, I&#39;ll close the ticket.

Thanks,
Dan Klein
UCSD Glidein Factory Operations

-- by Daniel Klein at Fri May 02 20&#58;34&#58;23 UTC 2014

GOCTX Source&#58; <a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a></pre></div><div class='update_description'><i onclick="document.location='20975#1399049508'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-02T16:51:48+00:00">May 2, 2014 04:51 PM UTC</time><a class="anchor" name="1399049508">&nbsp;</a></div><pre>Also, I just realized that we might have had a network glitch between 11 PM and 2 AM PST. So we probably want to look at the last 7, 6h.

Thanks,
Samir

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira</pre></div><div class='update_description'><i onclick="document.location='20975#1399046034'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-02T15:53:54+00:00">May 2, 2014 03:53 PM UTC</time><a class="anchor" name="1399046034">&nbsp;</a></div><pre>Hi Luis,

What is the timestamp of the failures? In the last 48h days we had some network outages. Knowing the timestamps will help me figure out if this was an echo of  that or not.

6-20 was the only one with a real problem, it was my guinea-pig when doing the NAT switchover, so it was left with a bad route. This is now fixed.

Do you see recent errors? All nodes are succeeding wget at least now (and I checked, they&#39;re using the right route/proxy) &#58;

[root@t2-headnode-new ~]# pssh -h /tmp/gwms-test.txt &#34;cd /tmp/; wget <a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh&#34' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh&#34</a>;
[1] 08&#58;53&#58;21 [SUCCESS] compute-6-20.tier2
[2] 08&#58;53&#58;21 [SUCCESS] compute-20-21.tier2
[3] 08&#58;53&#58;21 [SUCCESS] compute-22-18.tier2
[4] 08&#58;53&#58;21 [SUCCESS] compute-14-12.tier2
[5] 08&#58;53&#58;21 [SUCCESS] compute-6-17.tier2
[6] 08&#58;53&#58;21 [SUCCESS] compute-20-19.tier2
[7] 08&#58;53&#58;21 [SUCCESS] compute-14-8.tier2
[8] 08&#58;53&#58;21 [SUCCESS] compute-22-14.tier2
[9] 08&#58;53&#58;21 [SUCCESS] compute-14-58.tier2
[10] 08&#58;53&#58;21 [SUCCESS] compute-6-25.tier2
[11] 08&#58;53&#58;21 [SUCCESS] compute-22-23.tier2
[12] 08&#58;53&#58;21 [SUCCESS] compute-20-9.tier2
[13] 08&#58;53&#58;21 [SUCCESS] compute-12-17.tier2

Thanks,
Samir

[root@t2-headnode-new ~]# pssh -i -h /tmp/gwms-test.txt &#34;cd /tmp/; wget <a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh&#34' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh&#34</a>;

[2] 08&#58;50&#58;40 [SUCCESS] compute-14-12.tier2
Stderr&#58; --2014-05-02 08&#58;50&#58;42--  <a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh</a>
Resolving newman.ultralight.org... 131.215.207.102
Connecting to newman.ultralight.org|131.215.207.102|&#58;3128... connected.
Proxy request sent, awaiting response... 200 OK
Length&#58; 2755 (2.7K) [application/x-sh]
Saving to&#58; collector_setup.db5a4q.sh
<div id='show_1312038579' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1312038579'>
0K ..                                                    100%  356M=0s

2014-05-02 08&#58;50&#58;42 (356 MB/s) - collector_setup.db5a4q.sh saved [2755/2755]

===========================================

[root@compute-22-18 ~]# wget <a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh</a>
--2014-05-02 08&#58;48&#58;27--  <a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh</a>
Resolving newman.ultralight.org... 131.215.207.102
Connecting to newman.ultralight.org|131.215.207.102|&#58;3128... connected.
Proxy request sent, awaiting response... 200 OK
Length&#58; 2755 (2.7K) [application/x-sh]
Saving to&#58; collector_setup.db5a4q.sh

100%[====================================================================================================================================================&#62;] 2,755       --.-K/s   in 0s

2014-05-02 08&#58;48&#58;28 (80.9 MB/s) - collector_setup.db5a4q.sh saved [2755/2755]

by /DC=ch/DC=cern/OU=Organic Units/OU=Users/CN=samir/CN=695732/CN=Samir Cury Siqueira
</div><script type='text/javascript'>
        $('#show_1312038579').click(function() {
            $('#detail_1312038579').slideDown("normal");
            $('#show_1312038579').hide();
            $('#hide_1312038579').show();
        });
        $('#hide_1312038579').click(function() {
            $('#detail_1312038579').slideUp();
            $('#hide_1312038579').hide();
            $('#show_1312038579').show();
        });
        </script></pre></div><div class='update_description'><i onclick="document.location='20975#1399041638'; reset_anchor();" class="pull-right icon icon-share"></i><div class="header"><time datetime="2014-05-02T14:40:38+00:00">May 2, 2014 02:40 PM UTC</time> by <b>OSG-GOC</b><a class="anchor" name="1399041638">&nbsp;</a></div><pre>Hi Samir,

I have seen some of your worker nodes [1] fail to download some files [2] from several machines of the gWMS infrastructure, which I can download from elsewhere without issues. Can you please check them?

Cheers,
Luis

[1] WN list
compute-20-21.tier2
compute-22-14.tier2
compute-22-18.tier2
compute-6-20.tier2
compute-12-17.tier2
compute-14-12.tier2
compute-14-58.tier2
compute-14-8.tier2
compute-20-19.tier2
compute-20-9.tier2
compute-22-23.tier2
compute-6-17.tier2
compute-6-20.tier2
compute-6-25.tier2

[2] File list
<a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/collector_setup.db5a4q.sh</a>
<a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/create_temp_mapfile.db5a4q.sh' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/create_temp_mapfile.db5a4q.sh</a>
<a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/description.e3hgKD.cfg' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/description.e3hgKD.cfg</a>
<a href='http&#58;//glidein-collector-2.t2.ucsd.edu/vofrontend/stage/frontend_UCSD-v6_0/file_list.e3cbNv.lst' target='_blank' rel='nofollow'>http&#58;//glidein-collector-2.t2.ucsd.edu/vofrontend/stage/frontend_UCSD-v6_0/file_list.e3cbNv.lst</a>
<a href='http&#58;//glidein-collector-2.t2.ucsd.edu/vofrontend/stage/frontend_UCSD-o6_0/grid-mapfile.e3cd9t' target='_blank' rel='nofollow'>http&#58;//glidein-collector-2.t2.ucsd.edu/vofrontend/stage/frontend_UCSD-o6_0/grid-mapfile.e3cd9t</a>
<a href='http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/sethome.db5a4q.source' target='_blank' rel='nofollow'>http&#58;//vocms32.cern.ch/glidefactory/stage/glidein_v1_3/sethome.db5a4q.source</a>

[Ticket Origin]
<a href='https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108' target='_blank' rel='nofollow'>https&#58;//ggus.eu/ws/ticket_info.php?ticket=105108</a>

[Ticket History]
<div id='show_1020183647' class=''><button class="btn">Show More</button></div><div class='detail hidden' id='detail_1020183647'>Subject&#58; CMS_T2_US_Caltech worker node connectivity issues
Ticket Type&#58; USER
CC&#58; ;cms-comp-ops-site-support-team@....;osg-gfactory-support@....
-- by Luis Emiro Linares Garcia at Fri May 02 14&#58;40&#58;17 UTC 2014
</div><script type='text/javascript'>
        $('#show_1020183647').click(function() {
            $('#detail_1020183647').slideDown("normal");
            $('#show_1020183647').hide();
            $('#hide_1020183647').show();
        });
        $('#hide_1020183647').click(function() {
            $('#detail_1020183647').slideUp();
            $('#hide_1020183647').hide();
            $('#show_1020183647').show();
        });
        </script></pre></div><legend>Similar Recent Tickets <small>modified within the last 30 days</small></legend><div id="similar_tickets"><p class="muted">No similar tickets found.</p></div>
</div>
<script type="text/javascript">
function reset_anchor() {
    $("#updates .selected").removeClass("selected");
    var urls = document.location.toString().split('#'); 
    var anchor = urls[1];
    if(anchor) {
        $("a[name='"+anchor+"']").parents(".update_description").addClass("selected");
    }
}
function submitspam(ticket_id) {
    myret = confirm("Would you like to close this ticket as a security ticket, and submit the ticket content to akismet?");
    if(myret == true) {
        $.ajax("viewer/processspam?id="+ticket_id).done(function() {
            window.location.reload();
        });
    }
}

$(function() {
    reset_anchor();
    var ADDITIONAL_COOKIE_NAME = 'gocticket';
    var options = { path: '/', expires: 365};

    if(window.opener && window.opener.name == "gocticket_list") {
        v = $.cookie("closewindow");
        if(!v) {
            $("#closewindow").attr("checked", "checked"); //on by default
        } else {
            if(v == "checked") {
                $("#closewindow").attr("checked", "checked");
            }
        }
        $("#closewindow").click(function() {
            $.cookie("closewindow", $(this).attr('checked'), options);
        });
    } else {
        $("#closewindow_area").hide();
    }
    function updateTimeago() {
        $("time").timeago();
        setTimeout(updateTimeago, 30*1000);
    }
    updateTimeago();
    $(".description").focus(expand_description);
});
</script>
<hr/>
<footer>
<p>GOC Ticket Version 2.2 | <a href="https://ticket.opensciencegrid.org/goc/submit?app_issue_check=on&amp;app_issue_type=goc&amp;app_goc_url=https%3A%2F%2Fticket.opensciencegrid.org%3A443%2F20975">Report Bugs</a>
 | <a href="https://github.com/opensciencegrid/operations/blob/master/docs/privacy.md">Privacy Policy</a>
</p>

<p> <img align="top" src="images/tag_orange.png"/> Copyright 2018 The Trustees of Indiana University - Developed for Open Science Grid</p>
</footer>


</div><!--container-fluid-->
<script src="https://ticket1.grid.iu.edu:8443/socket.io/socket.io.js"></script>
<script>
var chat = io.connect('https://ticket1.grid.iu.edu:8443');
chat.on('connect', function() {
    chat.emit('authenticate', {nodekey:'', ticketid: 20975});
});
chat.on('peers', function(peers) {
    $("#peers").html("");
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('peer_disconnect', function(pid) {
    $("#peer_"+pid).hide("slow");
});
chat.on('peer_connected', function(peers) {
    //expect only 1 peer connecting, but..
    for(var pid in peers) {
        var peer = peers[pid];
        addPeer(pid, peer);
    }
});
chat.on('submit', function() {
    if(confirm("This ticket was updated. Do you want to refresh?")) {
        history.go(0);
    }
});

function addPeer(pid, peer) {
    var ipinfo = "";
    if(peer.ip != undefined) {
        ipinfo = "<span class=\"ip\">"+peer.ip+"</span>";
    }
    if(chat.io.engine.id == pid) {
        //don't display myself
        return;
    }
    var html = "<li class=\"new\" id=\"peer_"+pid+"\" class=\"peer\">"+peer.name+ipinfo+"</li>";
    $("#peers").prepend(html);
    $("#peers .new").animate({bottom: 0}, 1000, function() {$(this).removeClass("new")});
}

$(function() {
    $("#ticket_form").submit(function() {
        chat.emit('submit');
        return true;
    });
});
</script>
<script>
//used by searchbox
function parseValue(value) {
    var obj = new Object();
    var tokens = value.split("\t");
    obj.str = tokens[0];
    obj.count = tokens[1];
    return obj;
}

$(function() {
    //bootstrap-2.0.4 stuff
    $(".alert-message").alert();
    $(".dropdown-toggle").dropdown();
    $("span[rel='tooltip']").tooltip();
    $("a[rel=popover]").popover();

    //activate menu that user is currently on
    $("#menu_navigator").addClass("active"); 
    $("#submenu_").addClass("active"); 

    //translate zend validation error message to bootstrap
    $(".errors").addClass("alert").addClass("alert-error");

    //enable autocomplete for search box
    $("#search").autocomplete({
        source: function( request, response ) {
            $.ajax({
                url: "search/autocomplete",
                dataType: "text",
                data: {
                    //featureClass: "P",
                    //style: "full",
                    //maxRows: 12,
                    //name_startsWith: request.term
                    q: request.term
                },
                success: function( data ) {
                    response( $.map( data.split("\n"), function( item ) {
                        if(item == "") return null;
                        return {
                            value: item
                        }
                    }));
                }
            });
        },
        select: function(event, ui) {
            document.location = "search?q="+ui.item.value;
        }
    });
    
});
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-69012-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
